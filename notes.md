Improve performance [FguNa7] line 3.1
Refactor codebase with Z [G0XXV1] line 5.1
